# üéº WorkflowOrchestrator API Reference

**–ú–æ–¥—É–ª—å**: `src.core.workflow`  
**–ö–ª–∞—Å—Å**: `WorkflowOrchestrator`  
**–í–µ—Ä—Å–∏—è**: v3.0.2

---

## üìñ –û–±–∑–æ—Ä

`WorkflowOrchestrator` ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á—ë—Ç–æ–≤. –£–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –æ–ø–µ—Ä–∞—Ü–∏–π –æ—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ Bitrix24 –¥–æ —Å–æ–∑–¥–∞–Ω–∏—è Excel —Ñ–∞–π–ª–∞.

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üéØ **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞** –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á—ë—Ç–∞
- üìä **–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤** (Client ‚Üí Processor ‚Üí Generator)
- ‚ö° **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è v2.4.0** (batch –æ–±—Ä–∞–±–æ—Ç–∫–∞, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
- üõ°Ô∏è **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö
- üìà **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞** –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```python
from src.core.workflow import WorkflowOrchestrator

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
orchestrator = WorkflowOrchestrator(
    bitrix_client=client,
    data_processor=processor,
    excel_generator=generator
)

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞
success = orchestrator.generate_report(
    start_date="2024-01-01",
    end_date="2024-01-31",
    output_path="reports/january_2024.xlsx"
)

if success:
    print("–û—Ç—á—ë—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!")
```

---

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

### `__init__(bitrix_client, data_processor, excel_generator)`

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `bitrix_client` (`Bitrix24Client`) - –∫–ª–∏–µ–Ω—Ç Bitrix24
- `data_processor` (`DataProcessor`) - –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –¥–∞–Ω–Ω—ã—Ö
- `excel_generator` (`ExcelReportGenerator`) - –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä Excel

---

### `generate_report(start_date, end_date, output_path)`

–ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á—ë—Ç–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `start_date` (`str`) - –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ (YYYY-MM-DD)
- `end_date` (`str`) - –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ (YYYY-MM-DD)
- `output_path` (`str`) - –ø—É—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç—á—ë—Ç–∞

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: `bool` - —É—Å–ø–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–∏

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—á–µ—Ç–æ–≤ –∏–∑ Bitrix24
2. –û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ –∫–æ–º–ø–∞–Ω–∏–π (batch)
3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ (batch, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ)
4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
5. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —Å—á–µ—Ç–∞–º
6. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Excel –æ—Ç—á—ë—Ç–∞

**–ü—Ä–∏–º–µ—Ä:**

```python
success = orchestrator.generate_report(
    start_date="2024-01-01",
    end_date="2024-01-31",
    output_path="reports/report_january.xlsx"
)
```

---

## ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ v2.4.0

### Batch –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –ü–∞–∫–µ—Ç–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–π
- –ü–∞–∫–µ—Ç–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è API –∑–∞–ø—Ä–æ—Å–æ–≤

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ö—ç—à –∫–æ–º–ø–∞–Ω–∏–π –ø–æ –ò–ù–ù
- –ö—ç—à —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —Å—á–µ—Ç–∞–º
- –°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ API

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –î–æ 5-10x —É—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å—á–µ—Ç–æ–≤
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ rate limiting
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ

---

## üìö –°–º. —Ç–∞–∫–∂–µ

- [Bitrix24Client API](bitrix24-client.md) - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- [DataProcessor API](data-processor.md) - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- [ExcelReportGenerator API](excel-generator.md) - —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á—ë—Ç–æ–≤

---

**–û–±–Ω–æ–≤–ª–µ–Ω–æ**: 2025-11-01  
**–í–µ—Ä—Å–∏—è API**: v3.0.2
