# üõ†Ô∏è –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é –Ω–µ–ø–æ–ª–∞–¥–æ–∫ ReportB24

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ–º–æ–≥–∞–µ—Ç –±—ã—Å—Ç—Ä–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º `run_report.py` –∏–ª–∏ –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

<a id="python-–Ω–µ-—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω-–∏–ª–∏-–Ω–µ-–¥–æ—Å—Ç—É–ø–µ–Ω"></a>
## Python –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–ª–∏ –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω

**–°–∏–º–ø—Ç–æ–º—ã:** –∫–æ–º–∞–Ω–¥—ã `py`/`python` –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç—Å—è –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ Windows.  
**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```cmd
py --version
where python
```
**–†–µ—à–µ–Ω–∏–µ:**
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [Python 3.8+ –¥–ª—è Windows](https://www.python.org/downloads/windows/).
2. –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –æ—Ç–º–µ—Ç—å—Ç–µ ¬´Add Python to PATH¬ª.
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É.

<a id="–Ω–µ-—É–¥–∞—ë—Ç—Å—è-–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è-–∫-bitrix24"></a>
## –ù–µ —É–¥–∞—ë—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Bitrix24

**–°–∏–º–ø—Ç–æ–º—ã:** –≤ –∫–æ–Ω—Å–æ–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è `‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Bitrix24 API`.  
**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```cmd
py -c "from src.core.app import AppFactory;\nwith AppFactory.create_app('config.ini') as app: print(app.test_api_connection())"
```
–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ ‚Äî `True`.  
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `BITRIX_WEBHOOK_URL` –≤ `.env` (–¥–æ–ª–∂–µ–Ω –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ `/`).
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–µ–±—Ö—É–∫–∞ –µ—Å—Ç—å –ø—Ä–∞–≤–∞ `crm` –∏ `smart_invoice`.
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç–∞–ª–∞: `ping –≤–∞—à-–ø–æ—Ä—Ç–∞–ª.bitrix24.ru` –∏–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ URL –≤ –±—Ä–∞—É–∑–µ—Ä–µ.
4. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å–µ—Ç—å, –¥–æ–±–∞–≤—å—Ç–µ –¥–æ–º–µ–Ω Bitrix24 –≤ —Å–ø–∏—Å–æ–∫ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö.

<a id="–ø–∞–ø–∫–∞-reports-–Ω–µ-—Å–æ–∑–¥–∞—ë—Ç—Å—è-–∏–ª–∏-–Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞"></a>
## –ü–∞–ø–∫–∞ `reports` –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞

**–°–∏–º–ø—Ç–æ–º—ã:** –æ—Ç—á—ë—Ç –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è, –≤ –ª–æ–≥–∞—Ö –æ—à–∏–±–∫–∏ –¥–æ—Å—Ç—É–ø–∞.  
**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```cmd
dir reports
```
**–†–µ—à–µ–Ω–∏–µ:**
1. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –≤—Ä—É—á–Ω—É—é: `mkdir reports`.
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—É—Ç—å `defaultsavefolder` –≤ `config.ini` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é.
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ Windows: –≤–∫–ª–∞–¥–∫–∞ ¬´–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å¬ª ‚Üí —Ä–∞–∑—Ä–µ—à–∏—Ç–µ –∑–∞–ø–∏—Å—å —Ç–µ–∫—É—â–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
4. –ï—Å–ª–∏ –æ—Ç—á—ë—Ç –æ—Ç–∫—Ä—ã—Ç –≤ Excel, –∑–∞–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç.

<a id="–æ—à–∏–±–∫–∏-–≤-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"></a>
## –û—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–°–∏–º–ø—Ç–æ–º—ã:** —Å–æ–æ–±—â–µ–Ω–∏—è `‚ùå –û—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ config.ini`.  
**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```cmd
py -c "from src.config.config_reader import SecureConfigReader; SecureConfigReader('config.ini').validate()"
```
**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç ‚Äî `–¥–¥.–º–º.–≥–≥–≥–≥`.
2. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ø—É—Ç–µ–π (`defaultsavefolder`, `logfile`).
3. –î–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ—Å—è—Ç–∏—á–Ω—É—é —Ç–æ—á–∫—É.
4. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã –∏–∑ —à–∞–±–ª–æ–Ω–æ–≤: `copy config.ini.example config.ini`.

<a id="–≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ-–æ–∫—Ä—É–∂–µ–Ω–∏–µ-–Ω–µ-–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è"></a>
## –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:** –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–µ—Ñ–∏–∫—Å `(.venv)` –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω—ã–π Python.  
**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```cmd
where python
```
–ü—É—Ç—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å `.venv`.  
**–†–µ—à–µ–Ω–∏–µ:**
1. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ: `.\.venv\Scripts\activate`.
2. –ï—Å–ª–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–ª–∏—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è PowerShell, —Ä–∞–∑—Ä–µ—à–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã: `Set-ExecutionPolicy RemoteSigned -Scope CurrentUser` (–≤—ã–ø–æ–ª–Ω—è—Ç—å –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞).
3. –î–ª—è —Å–±—Ä–æ—Å–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è —É–¥–∞–ª–∏—Ç–µ `.venv` –∏ —Å–æ–∑–¥–∞–π—Ç–µ –∑–∞–Ω–æ–≤–æ: `py -3 -m venv .venv`.

